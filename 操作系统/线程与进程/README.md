# 线程与进程

## 基本概念

线程是 CPU 调度的最小单位，进程是资源分配的最小单位。

## 线程同步（线程安全）

- 互斥锁
- 条件变量
- 读写锁
- 信号量
- 自旋锁
- 屏障
- 原子操作
- IPC

## 进程间通信（IPC）

- 管道
- 有名管道
- 信号
- 消息队列
- 共享内存
- 信号量
- 套接字（socket）

## 线程的生命周期

![线程的生命周期](./01.png)

## 多线程与多进程

| 维度            | 多线程                         | 多进程                   | 优势   |
| --------------- | ------------------------------ | ------------------------ | ------ |
| 数据共享（读）  | 数据共享简单                   | 数据共享复杂（IPC）      | 多线程 |
| 数据同步（写）  | 数据同步复杂                   | 数据同步简单             | 多进程 |
| 内存            | 占用内存少                     | 占用内存多               | 多线程 |
| CPU（大量计算） | 切换快，CPU 利用率高           | 切换慢，CPU 利用率低     | 多线程 |
| 创建销毁切换    | 创建销毁切换简单，速度快       | 创建销毁切换复杂，速度慢 | 多线程 |
| 编程            | 编程复杂                       | 编程简单                 | 多进程 |
| 可靠性          | 一个线程挂掉将导致整个进程挂掉 | 进程间不会相互影响       | 多进程 |
| 分布式          | 更适合于多核分布式             | 更适合于多机分布式       | 多进程 |

## 线程与处理器（CPU）

多核处理器是指在一枚处理器中集成两个或多个完整的计算引擎（内核），即多个物理核心。

单核处理器即一个物理核心。

此外，还有逻辑核心的概念，一般一个物理核心对应一个逻辑核心（现在也有一个物理核心对应两个逻辑核心的处理器，但性能肯定比不上两个物理核心），一个逻辑核心可以处理一个线程。

在多线程程序中，若线程数量大于逻辑核心，那么操作系统会根据调度算法来决定线程的切换运行。
